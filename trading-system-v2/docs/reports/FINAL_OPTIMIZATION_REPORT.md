# æ•°æ®åº“è¿æ¥æ³„æ¼ä¼˜åŒ–ä¸å‰ç«¯å‚æ•°è°ƒæ•´ç•Œé¢é…ç½®å®ŒæˆæŠ¥å‘Š

**å®Œæˆæ—¶é—´**: 2025-10-20  
**ç‰ˆæœ¬**: V2.4.0  
**çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆ

---

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“è¿æ¥æ³„æ¼ä¼˜åŒ– âœ…

#### 1.1 ä¿®æ”¹æ•°æ®åº“è¿æ¥é…ç½®
**æ–‡ä»¶**: `src/database/connection.js`

**ä¿®æ”¹å†…å®¹**:
- âœ… ç§»é™¤æ— æ•ˆçš„MySQL2é…ç½®é€‰é¡¹ï¼ˆ`acquireTimeout`, `timeout`, `reconnect`ï¼‰
- âœ… æ·»åŠ æ­£ç¡®çš„è¿æ¥è¶…æ—¶é…ç½®ï¼š
  - `connectTimeout: 10000` - 10ç§’è¿æ¥è¶…æ—¶
  - `idleTimeout: 300000` - 5åˆ†é’Ÿç©ºé—²è¶…æ—¶
- âœ… å¯ç”¨è¿æ¥ä¿æ´»æœºåˆ¶ï¼š
  - `enableKeepAlive: true`
  - `keepAliveInitialDelay: 0`

**æ•ˆæœ**:
- âœ… æ¶ˆé™¤MySQL2é…ç½®è­¦å‘Š
- âœ… é˜²æ­¢è¿æ¥é•¿æ—¶é—´Sleep
- âœ… è‡ªåŠ¨å›æ”¶ç©ºé—²è¿æ¥

#### 1.2 æ·»åŠ è¿æ¥æ³„æ¼ç›‘æ§
**æ–°å¢åŠŸèƒ½**:
- âœ… `startLeakMonitor()` - å¯åŠ¨è¿æ¥æ³„æ¼ç›‘æ§
- âœ… `stopLeakMonitor()` - åœæ­¢è¿æ¥æ³„æ¼ç›‘æ§
- âœ… æ¯5åˆ†é’Ÿè‡ªåŠ¨æ£€æŸ¥è¿æ¥æ± çŠ¶æ€
- âœ… ç›‘æ§æŒ‡æ ‡ï¼š
  - æ€»è¿æ¥æ•°
  - ç©ºé—²è¿æ¥æ•°
  - æ´»è·ƒè¿æ¥æ•°
  - è¿æ¥ä½¿ç”¨ç‡
  - ç­‰å¾…è·å–è¿æ¥çš„è¯·æ±‚æ•°
- âœ… è‡ªåŠ¨è­¦å‘Šï¼š
  - è¿æ¥ä½¿ç”¨ç‡è¶…è¿‡80%æ—¶å‘å‡ºè­¦å‘Š
  - æ´»è·ƒè¿æ¥æ•°æ¥è¿‘è¿æ¥æ± ä¸Šé™æ—¶å‘å‡ºè­¦å‘Š

**æ—¥å¿—ç¤ºä¾‹**:
```
[æ•°æ®åº“è¿æ¥æ± ] çŠ¶æ€ç›‘æ§ {
  totalConnections: 10,
  freeConnections: 8,
  activeConnections: 2,
  connectionUsage: "20%",
  acquiringConnections: 0
}
```

---

### 2. å‰ç«¯å‚æ•°è°ƒæ•´ç•Œé¢é…ç½® âœ…

#### 2.1 å¯¼èˆªæ é…ç½®
**æ–‡ä»¶**: `src/web/index.html`

**ä¿®æ”¹å†…å®¹**:
- âœ… åœ¨å¯¼èˆªæ ä¸­æ·»åŠ "å‚æ•°è°ƒä¼˜"é“¾æ¥
- âœ… é“¾æ¥ä½ç½®ï¼šåœ¨"ç³»ç»Ÿç›‘æ§"å’Œ"æ–‡æ¡£"ä¹‹é—´
- âœ… å›¾æ ‡ï¼š`fas fa-sliders-h`
- âœ… é“¾æ¥åœ°å€ï¼š`/strategy-params`

**å¯¼èˆªæ ç»“æ„**:
```html
<a href="/strategy-params" class="nav-link" data-tab="strategy-params">
  <i class="fas fa-sliders-h"></i>
  å‚æ•°è°ƒä¼˜
</a>
```

#### 2.2 å‰ç«¯è·¯ç”±é…ç½®
**æ–‡ä»¶**: `src/main.js`

**ä¿®æ”¹å†…å®¹**:
- âœ… å°†`/strategy-params`ä»é€šç”¨è·¯ç”±ä¸­ç§»é™¤
- âœ… æ·»åŠ ç‹¬ç«‹çš„`/strategy-params`è·¯ç”±
- âœ… è·¯ç”±è¿”å›`strategy-params.html`è€Œä¸æ˜¯`index.html`

**è·¯ç”±é…ç½®**:
```javascript
// ç­–ç•¥å‚æ•°è°ƒä¼˜é¡µé¢
this.app.get('/strategy-params', (req, res) => {
  res.sendFile('strategy-params.html', { root: 'src/web' });
});
```

#### 2.3 å‰ç«¯é¡µé¢ä¿®å¤
**æ–‡ä»¶**: `src/web/strategy-params.html`

**ä¿®æ”¹å†…å®¹**:
- âœ… ä¿®æ­£CSSè·¯å¾„ï¼š`/css/strategy-params.css` â†’ `public/css/strategy-params.css`
- âœ… ä¿®æ­£CSSè·¯å¾„ï¼š`/css/style.css` â†’ `styles.css`
- âœ… ç¡®ä¿JavaScriptæ­£ç¡®åŠ è½½ï¼š`public/js/strategy-params.js`

---

### 3. éƒ¨ç½²éªŒè¯ âœ…

#### 3.1 æ–‡ä»¶ä¸Šä¼ 
- âœ… `src/database/connection.js` - å·²ä¸Šä¼ 
- âœ… `src/main.js` - å·²ä¸Šä¼ 
- âœ… `src/web/index.html` - å·²ä¸Šä¼ 
- âœ… `src/web/strategy-params.html` - å·²ä¸Šä¼ 

#### 3.2 åº”ç”¨é‡å¯
- âœ… main-appå·²é‡å¯
- âœ… ç­–ç•¥å‚æ•°ç®¡ç†å™¨åˆå§‹åŒ–æˆåŠŸ
- âœ… æ•°æ®åº“è¿æ¥ç›‘æ§å·²å¯åŠ¨

#### 3.3 åŠŸèƒ½éªŒè¯
- âœ… å‰ç«¯é¡µé¢å¯è®¿é—®ï¼š`https://smart.aimaventop.com/strategy-params`
- âœ… é¡µé¢æ ‡é¢˜æ­£ç¡®ï¼š`ç­–ç•¥å‚æ•°è°ƒä¼˜ - SmartFlow`
- âœ… JavaScriptæ­£ç¡®åŠ è½½ï¼š`strategy-params.js`
- âœ… å¯¼èˆªæ é“¾æ¥æ­£ç¡®æ˜¾ç¤ºï¼š`å‚æ•°è°ƒä¼˜`
- âœ… APIæ¥å£æ­£å¸¸å·¥ä½œï¼š`/api/v1/strategy-params/*`

---

## ğŸ“Š å½“å‰ç³»ç»ŸçŠ¶æ€

### æ•°æ®åº“è¿æ¥
- **æœ€å¤§è¿æ¥æ•°**: 50
- **å½“å‰è¿æ¥æ•°**: 12
- **è¿æ¥æ± é…ç½®**:
  - è¿æ¥è¶…æ—¶ï¼š10ç§’
  - ç©ºé—²è¶…æ—¶ï¼š5åˆ†é’Ÿ
  - è¿æ¥ä¿æ´»ï¼šå·²å¯ç”¨
- **çŠ¶æ€**: âœ… å·²ä¼˜åŒ–

### PM2è¿›ç¨‹
- âœ… **main-app**: æ­£å¸¸è¿è¡Œï¼ˆCPU 0%, å†…å­˜ 24.8MBï¼‰
- âœ… **strategy-worker**: æ­£å¸¸è¿è¡Œï¼ˆCPU 0%, å†…å­˜ 77.4MBï¼‰
- âœ… **data-cleaner**: æ­£å¸¸è¿è¡Œï¼ˆCPU 0%, å†…å­˜ 54.5MBï¼‰
- âœ… **monitor**: æ­£å¸¸è¿è¡Œï¼ˆCPU 0%, å†…å­˜ 78.3MBï¼‰

### APIæ¥å£
- âœ… `/api/v1/strategy-params/ICT/BALANCED` - æ­£å¸¸å·¥ä½œ
- âœ… `/api/v1/strategy-params/V3/BALANCED` - æ­£å¸¸å·¥ä½œ
- âœ… `/api/v1/strategy-params/ICT/AGGRESSIVE` - æ­£å¸¸å·¥ä½œ
- âœ… `/api/v1/strategy-params/V3/CONSERVATIVE` - æ­£å¸¸å·¥ä½œ
- âœ… æ‰€æœ‰å‚æ•°åŒ–APIæ¥å£æ­£å¸¸å·¥ä½œ

### å‰ç«¯é¡µé¢
- âœ… `/dashboard` - æ­£å¸¸å·¥ä½œ
- âœ… `/strategies` - æ­£å¸¸å·¥ä½œ
- âœ… `/monitoring` - æ­£å¸¸å·¥ä½œ
- âœ… `/smart-money` - æ­£å¸¸å·¥ä½œ
- âœ… `/large-orders` - æ­£å¸¸å·¥ä½œ
- âœ… `/docs` - æ­£å¸¸å·¥ä½œ
- âœ… `/strategy-params` - âœ… **æ­£å¸¸å·¥ä½œ**ï¼ˆå·²ä¿®å¤ï¼‰

---

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. æ•°æ®åº“è¿æ¥ä¼˜åŒ–
- âœ… é˜²æ­¢è¿æ¥æ³„æ¼
- âœ… è‡ªåŠ¨å›æ”¶ç©ºé—²è¿æ¥
- âœ… å®æ—¶ç›‘æ§è¿æ¥æ± çŠ¶æ€
- âœ… è‡ªåŠ¨è­¦å‘Šå¼‚å¸¸æƒ…å†µ

### 2. å‰ç«¯å‚æ•°è°ƒæ•´ç•Œé¢
- âœ… ç­–ç•¥é€‰æ‹©ï¼ˆICT/V3ï¼‰
- âœ… æ¨¡å¼é€‰æ‹©ï¼ˆæ¿€è¿›/ä¿å®ˆ/å¹³è¡¡ï¼‰
- âœ… å‚æ•°å¯¹æ¯”è¡¨æ ¼
- âœ… å‚æ•°è¯¦æƒ…é¢æ¿
- âœ… å›æµ‹ç»“æœå±•ç¤º
- âœ… å‚æ•°ä¿®æ”¹å†å²
- âœ… å‚æ•°ç¼–è¾‘æ¨¡æ€æ¡†

### 3. å‚æ•°åŒ–åŠŸèƒ½
- âœ… 282ä¸ªå‚æ•°ï¼ˆICT: 93ä¸ª, V3: 189ä¸ªï¼‰
- âœ… ä¸‰ç§å‚æ•°æ¨¡å¼ï¼ˆæ¿€è¿›/ä¿å®ˆ/å¹³è¡¡ï¼‰
- âœ… åŠ¨æ€å‚æ•°è°ƒæ•´
- âœ… å‚æ•°å€¼èŒƒå›´éªŒè¯
- âœ… å‚æ•°ä¿®æ”¹å†å²è®°å½•
- âœ… å›æµ‹ç»“æœè·Ÿè¸ª

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### 1. è®¿é—®å‚æ•°è°ƒæ•´ç•Œé¢
1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `https://smart.aimaventop.com`
2. ç‚¹å‡»å¯¼èˆªæ ä¸­çš„"å‚æ•°è°ƒä¼˜"é“¾æ¥
3. æˆ–ç›´æ¥è®¿é—® `https://smart.aimaventop.com/strategy-params`

### 2. æŸ¥çœ‹å‚æ•°å¯¹æ¯”
1. é€‰æ‹©ç­–ç•¥ï¼ˆICTæˆ–V3ï¼‰
2. é€‰æ‹©æ¨¡å¼ï¼ˆæ¿€è¿›ã€ä¿å®ˆæˆ–å¹³è¡¡ï¼‰
3. æŸ¥çœ‹å‚æ•°å¯¹æ¯”è¡¨æ ¼
4. æ¯”è¾ƒä¸åŒæ¨¡å¼çš„å‚æ•°å·®å¼‚

### 3. ä¿®æ”¹å‚æ•°
1. åœ¨å‚æ•°è¯¦æƒ…é¢æ¿ä¸­æ‰¾åˆ°è¦ä¿®æ”¹çš„å‚æ•°
2. ç‚¹å‡»"ä¿®æ”¹"æŒ‰é’®
3. è¾“å…¥æ–°å€¼
4. å¡«å†™ä¿®æ”¹åŸå› 
5. ç‚¹å‡»"ä¿å­˜"æŒ‰é’®

### 4. æŸ¥çœ‹å‚æ•°å†å²
1. åœ¨"å‚æ•°ä¿®æ”¹å†å²"é¢æ¿ä¸­æŸ¥çœ‹æ‰€æœ‰ä¿®æ”¹è®°å½•
2. æŸ¥çœ‹ä¿®æ”¹äººã€ä¿®æ”¹æ—¶é—´ã€ä¿®æ”¹åŸå› 
3. æŸ¥çœ‹å‚æ•°å˜åŒ–ï¼ˆæ—§å€¼ â†’ æ–°å€¼ï¼‰

### 5. æŸ¥çœ‹å›æµ‹ç»“æœ
1. åœ¨"å›æµ‹ç»“æœ"é¢æ¿ä¸­æŸ¥çœ‹ä¸åŒå‚æ•°æ¨¡å¼çš„å›æµ‹æ•°æ®
2. æ¯”è¾ƒèƒœç‡ã€ç›ˆäºæ¯”ã€æœ€å¤§å›æ’¤ç­‰æŒ‡æ ‡
3. é€‰æ‹©æœ€ä¼˜å‚æ•°æ¨¡å¼

---

## ğŸ”§ APIä½¿ç”¨ç¤ºä¾‹

### è·å–ICTç­–ç•¥å¹³è¡¡æ¨¡å¼å‚æ•°
```bash
curl https://smart.aimaventop.com/api/v1/strategy-params/ICT/BALANCED
```

### è·å–V3ç­–ç•¥æ¿€è¿›æ¨¡å¼å‚æ•°
```bash
curl https://smart.aimaventop.com/api/v1/strategy-params/V3/AGGRESSIVE
```

### æ›´æ–°å‚æ•°
```bash
curl -X PUT https://smart.aimaventop.com/api/v1/strategy-params/ICT/BALANCED/trend/dailyTrendThreshold \
  -H "Content-Type: application/json" \
  -d '{
    "value": "0.025",
    "changedBy": "user",
    "reason": "ä¼˜åŒ–è¶‹åŠ¿åˆ¤æ–­é˜ˆå€¼"
  }'
```

### è·å–å‚æ•°å†å²
```bash
curl https://smart.aimaventop.com/api/v1/strategy-params/ICT/BALANCED/history
```

### è·å–å›æµ‹ç»“æœ
```bash
curl https://smart.aimaventop.com/api/v1/strategy-params/ICT/BALANCED/backtest
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æ•ˆæœ

### æ•°æ®åº“è¿æ¥
- **ä¼˜åŒ–å‰**: æœ‰è¿æ¥é•¿æ—¶é—´Sleepï¼ˆæœ€é•¿14036ç§’ï¼‰
- **ä¼˜åŒ–å**: ç©ºé—²è¿æ¥5åˆ†é’Ÿåè‡ªåŠ¨å›æ”¶
- **æ•ˆæœ**: âœ… é˜²æ­¢è¿æ¥æ³„æ¼

### ç³»ç»Ÿè´Ÿè½½
- **ä¼˜åŒ–å‰**: Load average 7.47
- **ä¼˜åŒ–å**: Load average 5.20
- **æ•ˆæœ**: âœ… ç³»ç»Ÿè´Ÿè½½é™ä½30%

### APIå“åº”æ—¶é—´
- **å½“å‰**: 2.05ç§’
- **ç›®æ ‡**: < 500ms
- **çŠ¶æ€**: âš ï¸ éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–

---

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆ
- âœ… æ•°æ®åº“è¿æ¥æ³„æ¼ä¼˜åŒ–
- âœ… è¿æ¥æ³„æ¼ç›‘æ§åŠŸèƒ½
- âœ… å‰ç«¯å‚æ•°è°ƒæ•´ç•Œé¢
- âœ… å¯¼èˆªæ é“¾æ¥é…ç½®
- âœ… è·¯ç”±é…ç½®ä¼˜åŒ–
- âœ… æ‰€æœ‰åŠŸèƒ½éƒ¨ç½²åˆ°VPS

### åŠŸèƒ½éªŒè¯
- âœ… å‰ç«¯é¡µé¢å¯æ­£å¸¸è®¿é—®
- âœ… å‚æ•°è°ƒæ•´ç•Œé¢æ­£å¸¸æ˜¾ç¤º
- âœ… APIæ¥å£æ­£å¸¸å·¥ä½œ
- âœ… æ•°æ®åº“è¿æ¥ä¼˜åŒ–ç”Ÿæ•ˆ
- âœ… è¿æ¥ç›‘æ§æ­£å¸¸è¿è¡Œ

### ç”¨æˆ·ç°åœ¨å¯ä»¥
1. âœ… è®¿é—® `https://smart.aimaventop.com/strategy-params`
2. âœ… æŸ¥çœ‹ICTå’ŒV3ç­–ç•¥çš„ä¸‰ç§å‚æ•°æ¨¡å¼
3. âœ… å¯¹æ¯”ä¸åŒæ¨¡å¼çš„å‚æ•°å·®å¼‚
4. âœ… ä¿®æ”¹ç­–ç•¥å‚æ•°
5. âœ… æŸ¥çœ‹å‚æ•°ä¿®æ”¹å†å²
6. âœ… æŸ¥çœ‹å›æµ‹ç»“æœ

---

**éƒ¨ç½²çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆ  
**åŠŸèƒ½çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ  
**ç”¨æˆ·åé¦ˆ**: å¯ä»¥æ­£å¸¸è®¿é—®å’Œä½¿ç”¨å‚æ•°è°ƒæ•´ç•Œé¢

