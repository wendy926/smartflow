<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SmartFlow 交易策略系统</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
  <div class="container">
    <!-- 头部导航 -->
    <header class="header">
      <div class="logo">
        <i class="fas fa-chart-line"></i>
        <h1>SmartFlow</h1>
      </div>
      <nav class="nav">
        <a href="/dashboard" class="nav-link active" data-tab="dashboard">
          <i class="fas fa-tachometer-alt"></i>
          仪表板
        </a>
        <a href="/strategies" class="nav-link" data-tab="strategies">
          <i class="fas fa-chess"></i>
          策略执行
        </a>
        <a href="/monitoring" class="nav-link" data-tab="monitoring">
          <i class="fas fa-monitor-heart-rate"></i>
          系统监控
        </a>
        <a href="/statistics" class="nav-link" data-tab="statistics">
          <i class="fas fa-chart-bar"></i>
          胜率统计
        </a>
        <a href="/new-coin-monitor" class="nav-link" data-tab="new-coin-monitor">
          <i class="fas fa-coins"></i>
          新币监控
        </a>
        <a href="/tools" class="nav-link" data-tab="tools">
          <i class="fas fa-tools"></i>
          工具
        </a>
        <a href="/docs" class="nav-link" data-tab="docs">
          <i class="fas fa-book"></i>
          文档
        </a>
      </nav>
    </header>

    <!-- 主要内容区域 -->
    <main class="main-content">
      <!-- 仪表板 -->
      <div id="dashboard" class="tab-content active">
        <div class="page-header">
          <h2>交易策略仪表板</h2>
          <div class="status-indicators">
            <div class="status-item">
              <span class="status-label">系统状态</span>
              <span class="status-value status-online">在线</span>
            </div>
            <div class="status-item">
              <span class="status-label">最后更新</span>
              <span class="status-value" id="lastUpdate">--</span>
            </div>
          </div>
        </div>

        <!-- 宏观监控数据卡片 -->
        <div class="macro-monitoring-section">
          <div class="card">
            <div class="card-header">
              <h3>宏观数据监控</h3>
              <div class="card-actions">
                <button class="btn btn-secondary" id="refreshMacroData">
                  <i class="fas fa-sync-alt"></i>
                  刷新
                </button>
              </div>
            </div>
            <div class="card-content">
              <div class="macro-cards-grid">
                <!-- 资金流监控卡片 -->
                <div class="macro-card" id="fundFlowCard">
                  <div class="macro-card-header">
                    <div class="macro-card-icon">
                      <i class="fas fa-coins"></i>
                    </div>
                    <div class="macro-card-title">
                      <h4>资金流监控</h4>
                      <span class="macro-card-subtitle">链上大额资金流</span>
                    </div>
                  </div>
                  <div class="macro-card-content">
                    <div class="macro-metric">
                      <span class="macro-metric-label">BTC大额交易</span>
                      <span class="macro-metric-value" id="btcLargeTx">--</span>
                    </div>
                    <div class="macro-metric">
                      <span class="macro-metric-label">ETH大额转账</span>
                      <span class="macro-metric-value" id="ethLargeTx">--</span>
                    </div>
                    <div class="macro-status" id="fundFlowStatus">
                      <span class="status-indicator status-normal">正常</span>
                    </div>
                  </div>
                </div>

                <!-- 市场情绪监控卡片 -->
                <div class="macro-card" id="sentimentCard">
                  <div class="macro-card-header">
                    <div class="macro-card-icon">
                      <i class="fas fa-brain"></i>
                    </div>
                    <div class="macro-card-title">
                      <h4>市场情绪</h4>
                      <span class="macro-card-subtitle">恐惧贪婪指数</span>
                    </div>
                  </div>
                  <div class="macro-card-content">
                    <div class="macro-metric">
                      <span class="macro-metric-label">当前指数</span>
                      <span class="macro-metric-value" id="fearGreedIndex">--</span>
                    </div>
                    <div class="macro-metric">
                      <span class="macro-metric-label">情绪状态</span>
                      <span class="macro-metric-value" id="sentimentState">--</span>
                    </div>
                    <div class="macro-status" id="sentimentStatus">
                      <span class="status-indicator status-normal">正常</span>
                    </div>
                  </div>
                </div>

                <!-- 合约市场监控卡片 -->
                <div class="macro-card" id="futuresCard">
                  <div class="macro-card-header">
                    <div class="macro-card-icon">
                      <i class="fas fa-chart-area"></i>
                    </div>
                    <div class="macro-card-title">
                      <h4>合约市场</h4>
                      <span class="macro-card-subtitle">多空比 & 资金费率</span>
                    </div>
                  </div>
                  <div class="macro-card-content">
                    <div class="macro-metric">
                      <span class="macro-metric-label">多空比</span>
                      <span class="macro-metric-value" id="longShortRatio">--</span>
                    </div>
                    <div class="macro-metric">
                      <span class="macro-metric-label">资金费率</span>
                      <span class="macro-metric-value" id="fundingRate">--</span>
                    </div>
                    <div class="macro-metric">
                      <span class="macro-metric-label">未平仓合约 (4H对比)</span>
                      <span class="macro-metric-value" id="openInterest">--</span>
                    </div>
                    <div class="macro-status" id="futuresStatus">
                      <span class="status-indicator status-normal">正常</span>
                    </div>
                  </div>
                </div>

                <!-- 宏观指标监控卡片 -->
                <div class="macro-card" id="macroCard">
                  <div class="macro-card-header">
                    <div class="macro-card-icon">
                      <i class="fas fa-globe-americas"></i>
                    </div>
                    <div class="macro-card-title">
                      <h4>宏观指标</h4>
                      <span class="macro-card-subtitle">利率 & 通胀率</span>
                    </div>
                  </div>
                  <div class="macro-card-content">
                    <div class="macro-metric">
                      <span class="macro-metric-label">美联储利率</span>
                      <span class="macro-metric-value" id="fedFundsRate">--</span>
                    </div>
                    <div class="macro-metric">
                      <span class="macro-metric-label">CPI通胀率</span>
                      <span class="macro-metric-value" id="cpiRate">--</span>
                    </div>
                    <div class="macro-status" id="macroStatus">
                      <span class="status-indicator status-normal">正常</span>
                    </div>
                  </div>
                </div>

                <!-- 宏观数据趋势图卡片 -->
                <div class="macro-card macro-trend-card" id="macroTrendCard">
                  <div class="macro-card-header">
                    <div class="macro-card-icon">
                      <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="macro-card-title">
                      <h4>7天趋势分析</h4>
                      <span class="macro-card-subtitle">4小时时间单位</span>
                    </div>
                  </div>
                  <div class="macro-card-content">
                    <div class="trend-charts-container">
                      <!-- 市场情绪趋势图 -->
                      <div class="trend-chart-section">
                        <div class="trend-chart-header">
                          <h5>恐惧贪婪指数趋势</h5>
                          <div class="trend-chart-controls">
                            <button class="btn btn-sm btn-secondary" onclick="toggleChart('sentimentChart')">
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                        </div>
                        <div class="trend-chart-wrapper">
                          <canvas id="sentimentChart" width="400" height="200"></canvas>
                        </div>
                      </div>

                      <!-- 多空比趋势图 -->
                      <div class="trend-chart-section">
                        <div class="trend-chart-header">
                          <h5>多空比趋势</h5>
                          <div class="trend-chart-controls">
                            <button class="btn btn-sm btn-secondary" onclick="toggleChart('longShortChart')">
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                        </div>
                        <div class="trend-chart-wrapper">
                          <canvas id="longShortChart" width="400" height="200"></canvas>
                        </div>
                      </div>

                      <!-- 资金费率趋势图 -->
                      <div class="trend-chart-section">
                        <div class="trend-chart-header">
                          <h5>资金费率趋势</h5>
                          <div class="trend-chart-controls">
                            <button class="btn btn-sm btn-secondary" onclick="toggleChart('fundingRateChart')">
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                        </div>
                        <div class="trend-chart-wrapper">
                          <canvas id="fundingRateChart" width="400" height="200"></canvas>
                        </div>
                      </div>

                      <!-- 未平仓合约趋势图 -->
                      <div class="trend-chart-section">
                        <div class="trend-chart-header">
                          <h5>未平仓合约趋势</h5>
                          <div class="trend-chart-controls">
                            <button class="btn btn-sm btn-secondary" onclick="toggleChart('openInterestChart')">
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                        </div>
                        <div class="trend-chart-wrapper">
                          <canvas id="openInterestChart" width="400" height="200"></canvas>
                        </div>
                      </div>
                    </div>
                    <div class="macro-status" id="trendStatus">
                      <span class="status-indicator status-normal">正常</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 策略当前状态表格 -->
        <div class="card">
          <div class="card-header">
            <h3>策略当前状态</h3>
            <div class="card-actions">
              <div class="risk-selector">
                <label for="maxLossAmount">最大损失金额:</label>
                <select id="maxLossAmount" class="form-select">
                  <option value="20">20 USDT</option>
                  <option value="50">50 USDT</option>
                  <option value="100" selected>100 USDT</option>
                  <option value="200">200 USDT</option>
                </select>
              </div>
              <button class="btn btn-primary" id="refreshStrategyStatus">
                <i class="fas fa-sync-alt"></i>
                刷新
              </button>
            </div>
          </div>
          <div class="card-content">
            <div class="table-container">
              <table class="data-table" id="strategyStatusTable">
                <thead>
                  <tr>
                    <th>交易对</th>
                    <th>当前价格</th>
                    <th>策略</th>
                    <th>趋势</th>
                    <th>信号</th>
                    <th>高时间框架<br />趋势判断</th>
                    <th>中时间框架<br />多因子/OB区</th>
                    <th>低时间框架<br />入场判断</th>
                    <th>入场价格</th>
                    <th>止损价格</th>
                    <th>止盈价格</th>
                    <th>杠杆</th>
                    <th>保证金</th>
                  </tr>
                </thead>
                <tbody id="strategyStatusTableBody">
                  <!-- 数据将通过JavaScript动态加载 -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- 交易对监控已移除 -->
      </div>

      <!-- 策略执行页面 -->
      <div id="strategies" class="tab-content">
        <div class="page-header">
          <h2>策略执行与记录</h2>
          <div class="strategy-tabs">
            <button class="strategy-tab active" data-strategy="v3">Strategy V3</button>
            <button class="strategy-tab" data-strategy="ict">ICT Strategy</button>
          </div>
        </div>

        <!-- 策略统计卡片 -->
        <div class="cards-grid">
          <div class="card stats-card" id="v3-stats">
            <div class="card-header">
              <h3>V3策略统计</h3>
            </div>
            <div class="card-content">
              <div class="stats-grid">
                <div class="stat-item">
                  <span class="stat-label">总交易数</span>
                  <span class="stat-value total-trades">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">盈利交易</span>
                  <span class="stat-value profitable-trades">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">亏损交易</span>
                  <span class="stat-value losing-trades">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">胜率</span>
                  <span class="stat-value win-rate">0%</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">总盈亏</span>
                  <span class="stat-value total-pnl">$0.00</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">最大回撤</span>
                  <span class="stat-value max-drawdown">0%</span>
                </div>
              </div>
              <div class="overall-summary">
                <h4>系统总览</h4>
                <div class="summary-stats">
                  <div class="summary-item">
                    <span class="summary-label">活跃交易</span>
                    <span class="summary-value" id="v3-active-trades">0</span>
                  </div>
                  <div class="summary-item">
                    <span class="summary-label">今日交易</span>
                    <span class="summary-value" id="v3-today-trades">0</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card stats-card" id="ict-stats">
            <div class="card-header">
              <h3>ICT策略统计</h3>
            </div>
            <div class="card-content">
              <div class="stats-grid">
                <div class="stat-item">
                  <span class="stat-label">总交易数</span>
                  <span class="stat-value total-trades">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">盈利交易</span>
                  <span class="stat-value profitable-trades">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">亏损交易</span>
                  <span class="stat-value losing-trades">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">胜率</span>
                  <span class="stat-value win-rate">0%</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">总盈亏</span>
                  <span class="stat-value total-pnl">$0.00</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">最大回撤</span>
                  <span class="stat-value max-drawdown">0%</span>
                </div>
              </div>
              <div class="overall-summary">
                <h4>系统总览</h4>
                <div class="summary-stats">
                  <div class="summary-item">
                    <span class="summary-label">活跃交易</span>
                    <span class="summary-value" id="ict-active-trades">0</span>
                  </div>
                  <div class="summary-item">
                    <span class="summary-label">今日交易</span>
                    <span class="summary-value" id="ict-today-trades">0</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>

        <div class="strategy-content">
          <!-- Strategy V3 内容 -->
          <div id="v3-content" class="strategy-panel active">
            <div class="strategy-info">
              <h3>Strategy V3 - 多因子趋势策略</h3>
              <p>基于4H趋势判断、1H因子分析和15M入场信号的综合策略</p>
            </div>

            <!-- V3策略交易记录表格 -->
            <div class="trading-records">
              <h3>V3策略交易记录</h3>
              <div class="table-container">
                <table class="data-table" id="v3TradingRecordsTable">
                  <thead>
                    <tr>
                      <th>交易对</th>
                      <th>策略</th>
                      <th>方向</th>
                      <th>入场判断逻辑</th>
                      <th>入场时间</th>
                      <th>入场价格</th>
                      <th>止盈价格</th>
                      <th>止损价格</th>
                      <th>杠杆</th>
                      <th>保证金</th>
                      <th>状态</th>
                      <th>出场价格</th>
                      <th>出场原因</th>
                      <th>盈亏结果</th>
                      <th>盈亏金额</th>
                      <th>最大回撤</th>
                    </tr>
                  </thead>
                  <tbody id="v3-trades-body">
                    <!-- 数据将通过JavaScript动态加载 -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- ICT Strategy 内容 -->
          <div id="ict-content" class="strategy-panel">
            <div class="strategy-info">
              <h3>ICT Strategy - 订单块策略</h3>
              <p>基于订单块、流动性扫荡和吞没形态的ICT概念策略</p>
            </div>

            <!-- ICT策略交易记录表格 -->
            <div class="trading-records">
              <h3>ICT策略交易记录</h3>
              <div class="table-container">
                <table class="data-table" id="ictTradingRecordsTable">
                  <thead>
                    <tr>
                      <th>交易对</th>
                      <th>策略</th>
                      <th>方向</th>
                      <th>入场判断逻辑</th>
                      <th>入场时间</th>
                      <th>入场价格</th>
                      <th>止盈价格</th>
                      <th>止损价格</th>
                      <th>杠杆</th>
                      <th>保证金</th>
                      <th>状态</th>
                      <th>出场价格</th>
                      <th>出场原因</th>
                      <th>盈亏结果</th>
                      <th>盈亏金额</th>
                      <th>最大回撤</th>
                    </tr>
                  </thead>
                  <tbody id="ict-trades-body">
                    <!-- 数据将通过JavaScript动态加载 -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>


        </div>
      </div>

      <!-- 系统监控页面 -->
      <div id="monitoring" class="tab-content">
        <div class="page-header">
          <h2>系统监控</h2>
          <div class="monitoring-controls">
            <button class="btn btn-primary" id="refreshMonitoringBtn">
              <i class="fas fa-sync-alt"></i>
              刷新监控
            </button>
          </div>
        </div>

        <div class="monitoring-grid">
          <div class="card">
            <div class="card-header">
              <h3>系统资源</h3>
            </div>
            <div class="card-content">
              <div class="resource-item">
                <span class="resource-label">CPU使用率</span>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 35%"></div>
                </div>
                <span class="resource-value">35%</span>
              </div>
              <div class="resource-item">
                <span class="resource-label">内存使用率</span>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 68%"></div>
                </div>
                <span class="resource-value">68%</span>
              </div>
              <div class="resource-item">
                <span class="resource-label">磁盘使用率</span>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 45%"></div>
                </div>
                <span class="resource-value">45%</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3>API状态</h3>
            </div>
            <div class="card-content">
              <div class="api-status">
                <div class="api-item">
                  <span class="api-name">Binance REST API</span>
                  <span class="api-status-value status-online">正常</span>
                </div>
                <div class="api-item">
                  <span class="api-name">Binance WebSocket</span>
                  <span class="api-status-value status-online">正常</span>
                </div>
                <div class="api-item">
                  <span class="api-name">数据库连接</span>
                  <span class="api-status-value status-online">正常</span>
                </div>
                <div class="api-item">
                  <span class="api-name">Redis缓存</span>
                  <span class="api-status-value status-online">正常</span>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3>策略执行状态</h3>
            </div>
            <div class="card-content">
              <div class="strategy-status">
                <div class="strategy-status-item">
                  <span class="strategy-name">Strategy V3</span>
                  <span class="strategy-status-value status-running">运行中</span>
                </div>
                <div class="strategy-status-item">
                  <span class="strategy-name">ICT Strategy</span>
                  <span class="strategy-status-value status-running">运行中</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 胜率统计页面 -->
      <div id="statistics" class="tab-content">
        <div class="page-header">
          <h2>交易对胜率统计</h2>
          <div class="statistics-controls">
            <select class="form-select" id="strategySelect">
              <option value="all">所有策略</option>
              <option value="v3">Strategy V3</option>
              <option value="ict">ICT Strategy</option>
            </select>
            <select class="form-select" id="timeframeSelect">
              <option value="all">所有时间周期</option>
              <option value="1d">1天</option>
              <option value="4h">4小时</option>
              <option value="1h">1小时</option>
              <option value="15m">15分钟</option>
            </select>
          </div>
        </div>

        <div class="statistics-grid">
          <div class="card">
            <div class="card-header">
              <h3>总体统计</h3>
            </div>
            <div class="card-content">
              <div class="stat-item">
                <span class="stat-label">总交易数</span>
                <span class="stat-value" id="overall-total-trades">--</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">胜率</span>
                <span class="stat-value" id="overall-win-rate">--</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">总盈亏</span>
                <span class="stat-value" id="overall-total-pnl">--</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">最大回撤</span>
                <span class="stat-value" id="overall-max-drawdown">--</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3>策略对比</h3>
            </div>
            <div class="card-content">
              <div class="strategy-comparison">
                <div class="comparison-item">
                  <span class="comparison-name">Strategy V3</span>
                  <div class="comparison-bar">
                    <div class="comparison-fill" style="width: 72%"></div>
                  </div>
                  <span class="comparison-value">72%</span>
                </div>
                <div class="comparison-item">
                  <span class="comparison-name">ICT Strategy</span>
                  <div class="comparison-bar">
                    <div class="comparison-fill" style="width: 65%"></div>
                  </div>
                  <span class="comparison-value">65%</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h3>交易对详细统计</h3>
          </div>
          <div class="card-content">
            <div class="table-container">
              <table class="data-table" id="statisticsTable">
                <thead>
                  <tr>
                    <th>交易对</th>
                    <th>策略</th>
                    <th>时间周期</th>
                    <th>交易数</th>
                    <th>胜率</th>
                    <th>盈亏</th>
                    <th>夏普比率</th>
                  </tr>
                </thead>
                <tbody id="statisticsTableBody">
                  <!-- 数据将通过JavaScript动态加载 -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- 新币监控页面 -->
      <div id="new-coin-monitor" class="tab-content">
        <div class="page-header">
          <h2>新币监控中心</h2>
          <div class="status-indicators">
            <div class="status-item">
              <span class="status-label">监控状态</span>
              <span class="status-value" id="monitorStatus">--</span>
            </div>
            <div class="status-item">
              <span class="status-label">监控币种</span>
              <span class="status-value" id="monitoredCoinsCount">--</span>
            </div>
            <div class="status-item">
              <span class="status-label">最后评估</span>
              <span class="status-value" id="lastEvaluation">--</span>
            </div>
          </div>
        </div>

        <!-- 控制面板 -->
        <div class="control-panel">
          <div class="card">
            <div class="card-header">
              <h3>监控控制</h3>
              <div class="card-actions">
                <button class="btn btn-primary" id="addNewCoin">
                  <i class="fas fa-plus"></i>
                  添加新币
                </button>
                <button class="btn btn-secondary" id="manualEvaluate">
                  <i class="fas fa-sync-alt"></i>
                  手动评估
                </button>
                <button class="btn btn-secondary" id="refreshMonitorData">
                  <i class="fas fa-refresh"></i>
                  刷新数据
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- 新币概览表格 -->
        <div class="monitor-overview">
          <div class="card">
            <div class="card-header">
              <h3>新币监控概览</h3>
              <div class="card-actions">
                <div class="filter-controls">
                  <select id="scoreFilter" class="form-select">
                    <option value="">全部评分</option>
                    <option value="high">高评分 (≥8)</option>
                    <option value="medium">中评分 (6-8)</option>
                    <option value="low">低评分 (<6)< /option>
                  </select>
                  <select id="statusFilter" class="form-select">
                    <option value="">全部状态</option>
                    <option value="ACTIVE">活跃</option>
                    <option value="MONITORING">监控中</option>
                    <option value="INACTIVE">非活跃</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="card-content">
              <div class="table-container">
                <table class="data-table" id="coinOverviewTable">
                  <thead>
                    <tr>
                      <th>币种</th>
                      <th>名称</th>
                      <th>技术评分</th>
                      <th>代币经济</th>
                      <th>流动性</th>
                      <th>市场情绪</th>
                      <th>综合评分</th>
                      <th>策略建议</th>
                      <th>状态</th>
                      <th>操作</th>
                    </tr>
                  </thead>
                  <tbody id="coinOverviewBody">
                    <tr>
                      <td colspan="10" class="text-center">加载中...</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- 告警统计 -->
        <div class="alert-statistics">
          <div class="card">
            <div class="card-header">
              <h3>告警统计</h3>
            </div>
            <div class="card-content">
              <div class="alert-cards-grid" id="alertStatisticsGrid">
                <div class="alert-card">
                  <div class="alert-card-icon critical">
                    <i class="fas fa-exclamation-triangle"></i>
                  </div>
                  <div class="alert-card-content">
                    <div class="alert-card-title">严重告警</div>
                    <div class="alert-card-value" id="criticalAlerts">--</div>
                  </div>
                </div>
                <div class="alert-card">
                  <div class="alert-card-icon warning">
                    <i class="fas fa-exclamation-circle"></i>
                  </div>
                  <div class="alert-card-content">
                    <div class="alert-card-title">警告</div>
                    <div class="alert-card-value" id="warningAlerts">--</div>
                  </div>
                </div>
                <div class="alert-card">
                  <div class="alert-card-icon info">
                    <i class="fas fa-info-circle"></i>
                  </div>
                  <div class="alert-card-content">
                    <div class="alert-card-title">信息</div>
                    <div class="alert-card-value" id="infoAlerts">--</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 新币详情模态框 -->
        <div id="coinDetailModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h3 id="coinDetailTitle">新币详情</h3>
              <span class="close" id="closeCoinDetail">&times;</span>
            </div>
            <div class="modal-body" id="coinDetailBody">
              <!-- 详情内容将动态加载 -->
            </div>
          </div>
        </div>

        <!-- 添加新币模态框 -->
        <div id="addCoinModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h3>添加新币到监控</h3>
              <span class="close" id="closeAddCoin">&times;</span>
            </div>
            <div class="modal-body">
              <form id="addCoinForm">
                <div class="form-group">
                  <label for="coinSymbol">交易对符号 *</label>
                  <input type="text" id="coinSymbol" name="symbol" placeholder="如: EXAMPLEUSDT" required>
                </div>
                <div class="form-group">
                  <label for="coinName">代币名称 *</label>
                  <input type="text" id="coinName" name="name" placeholder="如: Example Coin" required>
                </div>
                <div class="form-group">
                  <label for="githubRepo">GitHub仓库</label>
                  <input type="text" id="githubRepo" name="github_repo" placeholder="如: username/repo">
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="teamScore">团队经验分 (0-10)</label>
                    <input type="number" id="teamScore" name="team_score" min="0" max="10" step="0.1" value="0">
                  </div>
                  <div class="form-group">
                    <label for="vestingLockScore">锁仓分 (0-10)</label>
                    <input type="number" id="vestingLockScore" name="vesting_lock_score" min="0" max="10" step="0.1"
                      value="0">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="supplyTotal">代币总量</label>
                    <input type="number" id="supplyTotal" name="supply_total" min="0" value="0">
                  </div>
                  <div class="form-group">
                    <label for="supplyCirculation">流通量</label>
                    <input type="number" id="supplyCirculation" name="supply_circulation" min="0" value="0">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="twitterFollowers">Twitter粉丝数</label>
                    <input type="number" id="twitterFollowers" name="twitter_followers" min="0" value="0">
                  </div>
                  <div class="form-group">
                    <label for="telegramMembers">Telegram成员数</label>
                    <input type="number" id="telegramMembers" name="telegram_members" min="0" value="0">
                  </div>
                </div>
                <div class="form-group">
                  <label for="listingDate">上线日期</label>
                  <input type="date" id="listingDate" name="listing_date">
                </div>
                <div class="form-actions">
                  <button type="button" class="btn btn-secondary" id="cancelAddCoin">取消</button>
                  <button type="submit" class="btn btn-primary">添加监控</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- 工具页面 -->
      <div id="tools" class="tab-content">
        <div class="page-header">
          <h2>交易工具</h2>
        </div>

        <div class="tools-grid">
          <div class="card">
            <div class="card-header">
              <h3>动态杠杆滚仓计算器</h3>
            </div>
            <div class="card-content">
              <div class="calculator-form">
                <div class="form-row">
                  <div class="form-group">
                    <label>本金 (USDT)</label>
                    <input type="number" id="principal" placeholder="200" class="form-input" value="200">
                  </div>
                  <div class="form-group">
                    <label>初始杠杆</label>
                    <input type="number" id="initialLeverage" placeholder="50" class="form-input" value="50">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>开仓价格</label>
                    <input type="number" id="priceStart" placeholder="4700" class="form-input" value="4700">
                  </div>
                  <div class="form-group">
                    <label>目标价格</label>
                    <input type="number" id="priceTarget" placeholder="5200" class="form-input" value="5200">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>滚仓触发比例</label>
                    <input type="number" id="triggerRatio" placeholder="1.0" step="0.1" class="form-input" value="1.0">
                  </div>
                  <div class="form-group">
                    <label>杠杆递减系数</label>
                    <input type="number" id="leverageDecay" placeholder="0.5" step="0.1" class="form-input" value="0.5">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label>利润锁定比例</label>
                    <input type="number" id="profitLockRatio" placeholder="0.5" step="0.1" class="form-input"
                      value="0.5">
                  </div>
                  <div class="form-group">
                    <label>最低杠杆</label>
                    <input type="number" id="minLeverage" placeholder="5" class="form-input" value="5">
                  </div>
                </div>
                <button class="btn btn-primary" id="calculateRollingBtn">计算动态滚仓</button>
              </div>
              <div class="calculator-result" id="rollingResult">
                <!-- 计算结果将显示在这里 -->
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3>Telegram监控设置</h3>
            </div>
            <div class="card-content">
              <div class="telegram-settings">
                <!-- 交易触发Telegram设置 -->
                <div class="telegram-section">
                  <h4>交易触发通知</h4>
                  <div class="form-group">
                    <label>Bot Token</label>
                    <input type="text" id="tradingTelegramBotToken" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
                      class="form-input">
                  </div>
                  <div class="form-group">
                    <label>Chat ID</label>
                    <input type="text" id="tradingTelegramChatId" placeholder="123456789" class="form-input">
                  </div>
                  <div class="form-group">
                    <button class="btn btn-primary" id="saveTradingTelegramBtn">保存设置</button>
                    <button class="btn btn-secondary" id="testTradingTelegramBtn">测试连接</button>
                  </div>
                  <div class="telegram-status" id="tradingTelegramStatus">
                    <!-- 状态将通过JavaScript动态加载 -->
                  </div>
                </div>

                <!-- 系统监控Telegram设置 -->
                <div class="telegram-section">
                  <h4>系统监控告警</h4>
                  <div class="form-group">
                    <label>Bot Token</label>
                    <input type="text" id="monitoringTelegramBotToken"
                      placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz" class="form-input">
                  </div>
                  <div class="form-group">
                    <label>Chat ID</label>
                    <input type="text" id="monitoringTelegramChatId" placeholder="123456789" class="form-input">
                  </div>
                  <div class="form-group">
                    <button class="btn btn-primary" id="saveMonitoringTelegramBtn">保存设置</button>
                    <button class="btn btn-secondary" id="testMonitoringTelegramBtn">测试连接</button>
                  </div>
                  <div class="telegram-status" id="monitoringTelegramStatus">
                    <!-- 状态将通过JavaScript动态加载 -->
                  </div>
                </div>

                <!-- 宏观数据监控Telegram设置 -->
                <div class="telegram-section">
                  <h4>宏观数据监控告警</h4>
                  <div class="form-group">
                    <label>Bot Token</label>
                    <input type="text" id="macroTelegramBotToken" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
                      class="form-input">
                  </div>
                  <div class="form-group">
                    <label>Chat ID</label>
                    <input type="text" id="macroTelegramChatId" placeholder="123456789" class="form-input">
                  </div>
                  <div class="form-group">
                    <label>告警阈值设置</label>
                    <div class="threshold-settings">
                      <div class="threshold-item">
                        <label>BTC大额转账阈值 (USD)</label>
                        <input type="number" id="btcThreshold" placeholder="10000000" class="form-input">
                      </div>
                      <div class="threshold-item">
                        <label>ETH大额转账阈值 (ETH)</label>
                        <input type="number" id="ethThreshold" placeholder="1000" class="form-input">
                      </div>
                      <div class="threshold-item">
                        <label>恐惧贪婪指数低阈值</label>
                        <input type="number" id="fearGreedLow" placeholder="20" class="form-input">
                      </div>
                      <div class="threshold-item">
                        <label>恐惧贪婪指数高阈值</label>
                        <input type="number" id="fearGreedHigh" placeholder="80" class="form-input">
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <button class="btn btn-primary" id="saveMacroTelegramBtn">保存设置</button>
                    <button class="btn btn-secondary" id="testMacroTelegramBtn">测试连接</button>
                  </div>
                  <div class="telegram-status" id="macroTelegramStatus">
                    <!-- 状态信息将显示在这里 -->
                  </div>
                </div>

                <!-- 新币监控Telegram设置 -->
                <div class="telegram-section">
                  <h4>新币监控告警</h4>
                  <div class="form-group">
                    <label>Bot Token</label>
                    <input type="text" id="newCoinTelegramBotToken" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
                      class="form-input">
                  </div>
                  <div class="form-group">
                    <label>Chat ID</label>
                    <input type="text" id="newCoinTelegramChatId" placeholder="123456789" class="form-input">
                  </div>
                  <div class="form-group">
                    <label>告警阈值设置</label>
                    <div class="threshold-settings">
                      <div class="threshold-item">
                        <label>高评分阈值 (≥8分)</label>
                        <input type="checkbox" id="highScoreAlert" checked>
                        <span class="checkbox-label">启用高评分新币告警</span>
                      </div>
                      <div class="threshold-item">
                        <label>低评分阈值 (<6分)< /label>
                            <input type="checkbox" id="lowScoreAlert" checked>
                            <span class="checkbox-label">启用低评分新币告警</span>
                      </div>
                      <div class="threshold-item">
                        <label>价格变动阈值 (%)</label>
                        <input type="number" id="priceChangeThreshold" placeholder="10" class="form-input">
                      </div>
                      <div class="threshold-item">
                        <label>流动性告警阈值</label>
                        <input type="number" id="liquidityThreshold" placeholder="5" class="form-input">
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <button class="btn btn-primary" id="saveNewCoinTelegramBtn">保存设置</button>
                    <button class="btn btn-secondary" id="testNewCoinTelegramBtn">测试连接</button>
                  </div>
                  <div class="telegram-status" id="newCoinTelegramStatus">
                    <!-- 状态信息将显示在这里 -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3>系统测试API</h3>
              <div class="card-actions">
                <button class="btn btn-primary" id="runAllAPITestsBtn">运行所有测试</button>
              </div>
            </div>
            <div class="card-content">
              <div class="api-test">
                <div class="test-group">
                  <button class="btn btn-secondary" data-test="health">健康检查</button>
                  <button class="btn btn-secondary" data-test="symbols">交易对API</button>
                  <button class="btn btn-secondary" data-test="strategies">策略状态API</button>
                  <button class="btn btn-secondary" data-test="trades">交易记录API</button>
                </div>
                <div class="test-group">
                  <button class="btn btn-secondary" data-test="monitoring">系统监控API</button>
                  <button class="btn btn-secondary" data-test="tools">工具API</button>
                  <button class="btn btn-secondary" data-test="telegram">Telegram API</button>
                  <button class="btn btn-secondary" data-test="v3-analyze">V3策略分析</button>
                </div>
                <div class="test-group">
                  <button class="btn btn-secondary" data-test="ict-analyze">ICT策略分析</button>
                  <button class="btn btn-secondary" data-test="create-trade">创建交易</button>
                </div>
                <div class="test-result" id="apiTestResult">
                  <!-- API测试结果将显示在这里 -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 文档页面 -->
      <div id="docs" class="tab-content">
        <div class="page-header">
          <h2>策略文档</h2>
          <p>SmartFlow交易系统策略实现逻辑说明</p>
        </div>

        <!-- 文档目录导航 -->
        <div class="doc-nav">
          <div class="doc-nav-header">
            <h3>📖 文档目录</h3>
          </div>
          <div class="doc-nav-content">
            <div class="doc-nav-section">
              <h4>📊 宏观数据监控</h4>
              <ul>
                <li><a href="#macro-overview">监控概述</a></li>
                <li><a href="#fund-flow">资金流监控</a></li>
                <li><a href="#market-sentiment">市场情绪监控</a></li>
                <li><a href="#futures-market">合约市场监控</a></li>
                <li><a href="#macro-indicators">宏观指标监控</a></li>
                <li><a href="#monitoring-config">监控配置</a></li>
              </ul>
            </div>
            <div class="doc-nav-section">
              <h4>🎯 交易策略</h4>
              <ul>
                <li><a href="#v3-strategy">V3多因子趋势策略</a></li>
                <li><a href="#ict-strategy">ICT订单块策略</a></li>
              </ul>
            </div>
            <div class="doc-nav-section">
              <h4>⚙️ 系统架构</h4>
              <ul>
                <li><a href="#tech-stack">技术栈</a></li>
                <li><a href="#core-components">核心组件</a></li>
                <li><a href="#risk-control">风险控制</a></li>
                <li><a href="#data-flow">数据流程</a></li>
              </ul>
            </div>
          </div>
        </div>

        <div class="docs-container">
          <!-- V3策略文档 -->
          <div class="strategy-doc" id="v3-strategy">
            <div class="doc-header">
              <h3>V3多因子趋势策略</h3>
              <span class="strategy-badge v3">V3</span>
            </div>
            <div class="doc-content">
              <h4>策略概述</h4>
              <p>V3策略是一个基于多时间框架分析的量化交易策略，通过4H趋势判断、1H多因子评分和15M入场确认三个层次进行交易决策。</p>

              <h4>时间框架分析</h4>
              <div class="timeframe-section">
                <div class="timeframe-item">
                  <h5>高时间框架 (4H) - 趋势判断</h5>
                  <ul>
                    <li><strong>MA20/MA50交叉</strong>：判断趋势方向，金叉为上升，死叉为下跌</li>
                    <li><strong>ADX指标</strong>：衡量趋势强度，ADX > 25为强趋势</li>
                    <li><strong>BBW指标</strong>：布林带宽度，反映市场波动性</li>
                    <li><strong>评分机制</strong>：0-10分，综合判断趋势强度和方向</li>
                  </ul>
                </div>

                <div class="timeframe-item">
                  <h5>中时间框架 (1H) - 多因子评分</h5>
                  <ul>
                    <li><strong>VWAP方向</strong>：成交量加权平均价格方向</li>
                    <li><strong>OI变化</strong>：持仓量变化，反映资金流向</li>
                    <li><strong>资金费率</strong>：市场情绪指标</li>
                    <li><strong>Delta值</strong>：买卖压力差值</li>
                    <li><strong>评分机制</strong>：0-6分，下边界3分+VWAP方向一致才有效</li>
                  </ul>
                </div>

                <div class="timeframe-item">
                  <h5>低时间框架 (15M) - 入场确认</h5>
                  <ul>
                    <li><strong>EMA20/EMA50</strong>：短期均线确认</li>
                    <li><strong>ATR指标</strong>：平均真实波幅，用于止损计算</li>
                    <li><strong>评分机制</strong>：0-2分，确认入场时机</li>
                  </ul>
                </div>
              </div>

              <h4>交易参数计算</h4>
              <div class="calculation-section">
                <h5>止损距离计算</h5>
                <p>使用2倍ATR作为止损距离：</p>
                <ul>
                  <li>多头：<code>stopLoss = entryPrice - (ATR × 2)</code></li>
                  <li>空头：<code>stopLoss = entryPrice + (ATR × 2)</code></li>
                </ul>

                <h5>杠杆和保证金计算</h5>
                <p>严格按照文档公式计算：</p>
                <ul>
                  <li><strong>止损距离X%</strong>：<code>|entryPrice - stopLoss| / entryPrice</code></li>
                  <li><strong>最大杠杆数Y</strong>：<code>Math.floor(1 / (X% + 0.5%))</code></li>
                  <li><strong>最小保证金Z</strong>：<code>Math.ceil(M / (Y × X%))</code></li>
                </ul>
                <p>其中M为最大损失金额（默认100 USDT）</p>
              </div>

              <h4>交易信号生成</h4>
              <p>当三个时间框架都判断有效时，生成交易信号：</p>
              <ul>
                <li><strong>BUY信号</strong>：4H上升趋势 + 1H多因子有效 + 15M入场确认</li>
                <li><strong>SELL信号</strong>：4H下跌趋势 + 1H多因子有效 + 15M入场确认</li>
                <li><strong>HOLD信号</strong>：任一时间框架判断无效</li>
              </ul>
            </div>
          </div>

          <!-- ICT策略文档 -->
          <div class="strategy-doc" id="ict-strategy">
            <div class="doc-header">
              <h3>ICT订单块策略</h3>
              <span class="strategy-badge ict">ICT</span>
            </div>
            <div class="doc-content">
              <h4>策略概述</h4>
              <p>ICT（Inner Circle Trader）策略基于订单块理论，通过识别机构订单区域和价格扫荡行为进行交易决策。</p>

              <h4>时间框架分析</h4>
              <div class="timeframe-section">
                <div class="timeframe-item">
                  <h5>高时间框架 (1D) - 趋势判断</h5>
                  <ul>
                    <li><strong>20日价格变化</strong>：计算20个交易日的价格变化率</li>
                    <li><strong>趋势判断</strong>：基于价格变化幅度确定趋势方向</li>
                    <li><strong>震荡市处理</strong>：震荡市不计算交易参数</li>
                  </ul>
                </div>

                <div class="timeframe-item">
                  <h5>中时间框架 (4H) - 订单块检测</h5>
                  <ul>
                    <li><strong>订单块识别</strong>：检测机构订单区域</li>
                    <li><strong>ATR计算</strong>：用于订单块有效性判断</li>
                    <li><strong>扫荡检测</strong>：检测价格是否扫荡订单块</li>
                    <li><strong>扫荡速率</strong>：计算扫荡速度，反映市场动能</li>
                  </ul>
                </div>

                <div class="timeframe-item">
                  <h5>低时间框架 (15M) - 入场确认</h5>
                  <ul>
                    <li><strong>吞没形态</strong>：检测K线吞没模式</li>
                    <li><strong>ATR指标</strong>：用于止损计算</li>
                    <li><strong>成交量分析</strong>：确认入场时机</li>
                    <li><strong>扫荡速率</strong>：低时间框架扫荡确认</li>
                  </ul>
                </div>
              </div>

              <h4>订单块理论</h4>
              <div class="theory-section">
                <h5>订单块识别</h5>
                <p>订单块是机构大单集中的价格区域，具有以下特征：</p>
                <ul>
                  <li>价格在该区域停留时间较长</li>
                  <li>成交量相对集中</li>
                  <li>后续价格突破该区域时具有较强动能</li>
                </ul>

                <h5>扫荡检测</h5>
                <p>扫荡是指价格快速穿越订单块区域的行为：</p>
                <ul>
                  <li>检测价格是否突破订单块边界</li>
                  <li>计算扫荡速率，反映市场动能强度</li>
                  <li>扫荡后价格回归为有效信号</li>
                </ul>
              </div>

              <h4>交易参数计算</h4>
              <div class="calculation-section">
                <h5>止损距离计算</h5>
                <p>同样使用2倍ATR作为止损距离，与V3策略保持一致。</p>

                <h5>杠杆和保证金计算</h5>
                <p>使用与V3策略相同的计算公式，确保风险控制一致性。</p>
              </div>

              <h4>交易信号生成</h4>
              <p>基于订单块理论和扫荡行为：</p>
              <ul>
                <li><strong>BUY信号</strong>：1D上升趋势 + 4H订单块有效 + 15M入场确认</li>
                <li><strong>SELL信号</strong>：1D下跌趋势 + 4H订单块有效 + 15M入场确认</li>
                <li><strong>HOLD信号</strong>：震荡市或任一条件不满足</li>
              </ul>
            </div>
          </div>

          <!-- 宏观数据监控文档 -->
          <div class="strategy-doc" id="macro-monitoring">
            <div class="doc-header">
              <h3>宏观数据监控</h3>
              <span class="strategy-badge macro">宏观</span>
            </div>
            <div class="doc-content">
              <h4 id="macro-overview">监控概述</h4>
              <p>宏观数据监控系统实时监控链上资金流、市场情绪、合约市场风险和宏观经济指标，为交易决策提供宏观层面的数据支持。</p>

              <h4 id="fund-flow">资金流监控</h4>
              <h5>监控指标</h5>
              <ul>
                <li><strong>BTC大额交易</strong>：监控超过500万美元的BTC转账</li>
                <li><strong>ETH大额转账</strong>：监控超过1000万美元的ETH转账</li>
                <li><strong>交易所资金流</strong>：识别Binance、Coinbase、Kraken等交易所的进出资金</li>
                <li><strong>巨鲸活动</strong>：监控已知巨鲸地址的大额转账</li>
              </ul>

              <h5>数据源</h5>
              <ul>
                <li><strong>Blockchair API</strong>：BTC大额交易数据，支持API Key认证</li>
                <li><strong>Ethplorer API</strong>：ETH大额转账数据，免费API</li>
                <li><strong>地址标签库</strong>：内置交易所和巨鲸地址识别</li>
              </ul>

              <h5>计算逻辑</h5>
              <ul>
                <li><strong>阈值过滤</strong>：BTC > $5M，ETH > $10M</li>
                <li><strong>地址识别</strong>：通过地址标签库识别交易所和巨鲸</li>
                <li><strong>转账模式</strong>：检测交易所进出、巨鲸转账等特殊模式</li>
                <li><strong>告警机制</strong>：超过阈值时触发告警通知</li>
              </ul>

              <h4 id="market-sentiment">市场情绪监控</h4>
              <h5>监控指标</h5>
              <ul>
                <li><strong>恐惧贪婪指数</strong>：0-100分，反映市场情绪状态</li>
                <li><strong>情绪分类</strong>：极度恐惧、恐惧、中性、贪婪、极度贪婪</li>
              </ul>

              <h5>数据源</h5>
              <ul>
                <li><strong>Alternative.me API</strong>：恐惧贪婪指数数据，免费API</li>
              </ul>

              <h5>计算逻辑</h5>
              <ul>
                <li><strong>指数范围</strong>：0-100，数值越高越贪婪</li>
                <li><strong>分类标准</strong>：
                  <ul>
                    <li>0-20：极度恐惧</li>
                    <li>21-40：恐惧</li>
                    <li>41-60：中性</li>
                    <li>61-80：贪婪</li>
                    <li>81-100：极度贪婪</li>
                  </ul>
                </li>
                <li><strong>告警阈值</strong>：可配置低阈值（默认20）和高阈值（默认80）</li>
              </ul>

              <h4 id="futures-market">合约市场监控</h4>
              <h5>监控指标</h5>
              <ul>
                <li><strong>多空比</strong>：多头持仓与空头持仓的比例</li>
                <li><strong>资金费率</strong>：永续合约的资金费率</li>
                <li><strong>未平仓合约</strong>：当前未平仓的合约总价值</li>
              </ul>

              <h5>数据源</h5>
              <ul>
                <li><strong>Binance API</strong>：多空比、资金费率、未平仓合约数据</li>
                <li><strong>OKX API</strong>：资金费率、未平仓合约数据</li>
                <li><strong>Bybit API</strong>：多空比数据（v5版本）</li>
              </ul>

              <h5>计算逻辑</h5>
              <ul>
                <li><strong>多空比</strong>：多头持仓数量 / 空头持仓数量，显示为"1.27:1"格式</li>
                <li><strong>资金费率</strong>：实时资金费率，转换为百分比显示</li>
                <li><strong>未平仓合约</strong>：各交易所未平仓合约总和，以USD显示，包含4小时涨跌百分比</li>
                <li><strong>涨跌百分比</strong>：与4小时前的数据对比，显示变化幅度</li>
                <li><strong>数据更新</strong>：每4小时更新一次宏观监控，每5分钟更新一次价格数据</li>
              </ul>

              <h4 id="macro-indicators">宏观指标监控</h4>
              <h5>监控指标</h5>
              <ul>
                <li><strong>美联储利率</strong>：美国联邦基金利率</li>
                <li><strong>CPI通胀率</strong>：消费者价格指数同比变化率</li>
              </ul>

              <h5>数据源</h5>
              <ul>
                <li><strong>FRED API</strong>：美联储经济数据，需要API Key认证</li>
                <li><strong>数据系列</strong>：
                  <ul>
                    <li>FEDFUNDS：联邦基金利率</li>
                    <li>CPIAUCSL：消费者价格指数</li>
                  </ul>
                </li>
              </ul>

              <h5>计算逻辑</h5>
              <ul>
                <li><strong>美联储利率</strong>：直接获取最新利率值</li>
                <li><strong>CPI通胀率</strong>：计算同比变化率
                  <ul>
                    <li>公式：((当前CPI - 去年同期CPI) / 去年同期CPI) × 100%</li>
                    <li>数据频率：月度更新</li>
                  </ul>
                </li>
                <li><strong>告警阈值</strong>：可配置CPI通胀率高低阈值</li>
              </ul>

              <h4 id="monitoring-config">监控配置</h4>
              <h5>更新频率</h5>
              <ul>
                <li><strong>资金流监控</strong>：每4小时自动检查一次，支持手动刷新</li>
                <li><strong>市场情绪</strong>：每4小时自动更新一次，支持手动刷新</li>
                <li><strong>合约市场</strong>：每4小时自动更新一次，支持手动刷新</li>
                <li><strong>宏观指标</strong>：每4小时自动检查一次（数据源更新频率较低），支持手动刷新</li>
                <li><strong>手动刷新</strong>：点击刷新按钮会触发真实外部API调用，获取最新数据</li>
              </ul>

              <h5>告警设置</h5>
              <ul>
                <li><strong>Telegram通知</strong>：支持配置Bot Token和Chat ID</li>
                <li><strong>告警阈值</strong>：可自定义各指标的告警阈值</li>
                <li><strong>冷却机制</strong>：防止频繁告警</li>
              </ul>

              <h5>数据存储</h5>
              <ul>
                <li><strong>数据库表</strong>：macro_monitoring_data存储历史数据</li>
                <li><strong>缓存机制</strong>：Redis缓存最新数据，提高响应速度</li>
                <li><strong>数据保留</strong>：历史数据保留30天</li>
              </ul>
            </div>
          </div>

          <!-- 系统架构文档 -->
          <div class="strategy-doc" id="system-architecture">
            <div class="doc-header">
              <h3>系统架构说明</h3>
              <span class="strategy-badge system">系统</span>
            </div>
            <div class="doc-content">
              <h4>技术栈</h4>
              <ul>
                <li><strong>后端</strong>：Node.js + Express.js</li>
                <li><strong>数据库</strong>：MySQL 8.0</li>
                <li><strong>缓存</strong>：Redis</li>
                <li><strong>前端</strong>：原生JavaScript + HTML5 + CSS3</li>
                <li><strong>数据源</strong>：Binance API (REST + WebSocket)</li>
              </ul>

              <h4>核心组件</h4>
              <ul>
                <li><strong>策略引擎</strong>：V3和ICT策略实现</li>
                <li><strong>交易管理器</strong>：交易创建、状态管理、去重逻辑</li>
                <li><strong>数据更新器</strong>：实时数据获取和缓存</li>
                <li><strong>监控系统</strong>：系统资源监控和告警</li>
                <li><strong>通知系统</strong>：Telegram集成</li>
              </ul>

              <h4>风险控制</h4>
              <ul>
                <li><strong>交易去重</strong>：同一交易对同时只能有一个活跃交易</li>
                <li><strong>杠杆限制</strong>：最大杠杆20倍，基于止损距离动态计算</li>
                <li><strong>保证金管理</strong>：基于最大损失金额计算最小保证金</li>
                <li><strong>止损机制</strong>：基于ATR的动态止损</li>
              </ul>

              <h4>数据流程</h4>
              <ol>
                <li>从Binance API获取实时市场数据</li>
                <li>计算技术指标（MA、EMA、ADX、BBW、ATR等）</li>
                <li>执行策略逻辑判断</li>
                <li>生成交易信号和参数</li>
                <li>检查交易条件和去重逻辑</li>
                <li>创建交易记录并更新数据库</li>
                <li>发送通知和更新前端显示</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- 返回顶部按钮 -->
  <button class="back-to-top" id="backToTop" title="返回顶部">
    <i class="fas fa-arrow-up"></i>
  </button>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
  <script src="app.js"></script>
</body>

</html>