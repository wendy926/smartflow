# VPSæ‰‹åŠ¨éƒ¨ç½²æŒ‡å— (2025-10-08)

## âœ… Gitå·²æ¨é€æˆåŠŸ

**æäº¤ä¿¡æ¯ï¼š** `fix: ç­–ç•¥é€»è¾‘ä¼˜åŒ–å’Œæ–‡æ¡£æ›´æ–° (2025-10-08)`  
**æäº¤å“ˆå¸Œï¼š** `b714f94`  
**GitHubä»“åº“ï¼š** https://github.com/wendy926/smartflow.git

---

## ğŸš€ VPSéƒ¨ç½²æ­¥éª¤

### æ–¹å¼1ï¼šä½¿ç”¨VPS Webç»ˆç«¯

1. **ç™»å½•VPS Webæ§åˆ¶å°**
   - è®¿é—®VPSæä¾›å•†çš„ç®¡ç†é¢æ¿
   - æ‰“å¼€Webç»ˆç«¯

2. **æ‹‰å–æœ€æ–°ä»£ç **
   ```bash
   cd /root/trading-system-v2
   git pull origin main
   ```

3. **æ£€æŸ¥æ›´æ–°çš„æ–‡ä»¶**
   ```bash
   git log --oneline -1
   git show --name-only
   ```

4. **é‡å¯æœåŠ¡**
   ```bash
   pm2 restart main-app
   pm2 restart strategy-worker
   nginx -s reload
   ```

5. **éªŒè¯éƒ¨ç½²**
   ```bash
   pm2 status
   pm2 logs main-app --lines 20
   ```

---

### æ–¹å¼2ï¼šä¿®å¤SSHè¿æ¥åéƒ¨ç½²

å¦‚æœSSHè¿æ¥æ¢å¤ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# å•æ¡å‘½ä»¤å®Œæˆæ‰€æœ‰æ“ä½œ
ssh root@smart.aimaventop.com "cd /root/trading-system-v2 && git pull origin main && pm2 restart all && nginx -s reload && pm2 status"
```

---

### æ–¹å¼3ï¼šä½¿ç”¨VPSæ–‡ä»¶ç®¡ç†å™¨

å¦‚æœæ— æ³•ä½¿ç”¨ç»ˆç«¯ï¼š

1. ç™»å½•VPSæ–‡ä»¶ç®¡ç†å™¨
2. ä¸‹è½½GitHubä¸Šçš„æœ€æ–°æ–‡ä»¶
3. ä¸Šä¼ åˆ°å¯¹åº”ç›®å½•ï¼š
   - `src/strategies/ict-strategy.js`
   - `src/strategies/v3-strategy.js`
   - `src/web/app.js`
   - `src/web/index.html`
4. ä½¿ç”¨Webç»ˆç«¯é‡å¯æœåŠ¡

---

## ğŸ“‹ éƒ¨ç½²æ¸…å•

### æ›´æ–°çš„æ–‡ä»¶ï¼ˆ4ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼‰

âœ… **src/strategies/ict-strategy.js**
- 15åˆ†é’Ÿå…¥åœºå¢åŠ å¼ºä¿¡å·è¦æ±‚ï¼ˆâ‰¥60åˆ†ï¼‰
- æ¶ˆé™¤ç¡¬ç¼–ç åˆ†æ•°ï¼ˆ30/40åˆ†ï¼‰
- ç»Ÿä¸€ç½®ä¿¡åº¦è®¡ç®—ä¸ºæ•°å€¼
- æ·»åŠ engulfingTypeå­—æ®µ

âœ… **src/strategies/v3-strategy.js**
- ä¿®å¤éœ‡è¡å¸‚å‡çªç ´ä¿¡å·å¤„ç†
- combineSignalsæ£€æŸ¥RANGEæ¨¡å¼

âœ… **src/web/app.js**
- 15Må…¥åœºåˆ¤æ–­å¢åŠ æ€»åˆ†â‰¥60åˆ†æ£€æŸ¥
- å‰ç«¯é€»è¾‘ä¸åç«¯å®Œå…¨ä¸€è‡´

âœ… **src/web/index.html**
- V3ç­–ç•¥ï¼šåŠ¨æ€æƒé‡ã€è¡¥å¿æœºåˆ¶ã€éœ‡è¡å¸‚é€»è¾‘ã€æ æ†24å€
- ICTç­–ç•¥ï¼š5ä¸ªé—¨æ§›ã€60åˆ†é˜ˆå€¼ã€è®¢å•å—5å¤©ã€æ æ†24å€

---

## ğŸ” éƒ¨ç½²åéªŒè¯

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
ssh root@smart.aimaventop.com "pm2 status"
```

**é¢„æœŸè¾“å‡ºï¼š**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name           â”‚ status  â”‚ restart â”‚ uptime  â”‚ cpu      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ main-app       â”‚ online  â”‚ 0       â”‚ 10s     â”‚ 5%       â”‚
â”‚ 1  â”‚ strategy-workerâ”‚ online  â”‚ 0       â”‚ 10s     â”‚ 3%       â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. æµ‹è¯•ICTç­–ç•¥API

```bash
curl -s "https://smart.aimaventop.com/api/v1/strategies/current-status?limit=2" | \
  jq '.data[] | {
    symbol, 
    ict: {
      signal, 
      score, 
      confidence: (.ict.confidence | type),
      trend,
      engulfingType: .ict.timeframes."15M".engulfingType
    }
  }'
```

**éªŒè¯è¦ç‚¹ï¼š**
- âœ… `confidence` ç±»å‹åº”ä¸º"number"
- âœ… `engulfingType` å­—æ®µå­˜åœ¨
- âœ… `score` ä¸åº”å‡ºç°30æˆ–40çš„ç¡¬ç¼–ç å€¼
- âœ… åªæœ‰æ€»åˆ†â‰¥60çš„äº¤æ˜“å¯¹æ‰å¯èƒ½è§¦å‘BUY/SELL

---

### 3. æµ‹è¯•V3ç­–ç•¥éœ‡è¡å¸‚é€»è¾‘

```bash
curl -s "https://smart.aimaventop.com/api/v1/strategies/v3/analyze" \
  -H "Content-Type: application/json" \
  -d '{"symbol": "BTCUSDT"}' | \
  jq '{signal: .data.signal, trend: .data.timeframes."4H".trend}'
```

**éªŒè¯è¦ç‚¹ï¼š**
- âœ… å¦‚æœtrendä¸º"RANGE"ä¸”æœ‰å‡çªç ´ï¼Œsignalåº”ä¸ºBUY/SELL
- âœ… å¦‚æœtrendä¸º"RANGE"ä½†æ— å‡çªç ´ï¼Œsignalåº”ä¸ºHOLD

---

### 4. éªŒè¯åœ¨çº¿æ–‡æ¡£

**è®¿é—®ï¼š** https://smart.aimaventop.com/docs

**éªŒè¯æ¸…å•ï¼š**

#### V3ç­–ç•¥éƒ¨åˆ†
- [ ] ç‚¹å‡»å·¦ä¾§"V3å¤šå› å­è¶‹åŠ¿ç­–ç•¥"èƒ½æ­£å¸¸è·³è½¬
- [ ] çœ‹åˆ°"åŠ¨æ€æƒé‡è°ƒæ•´"è¡¨æ ¼ï¼ˆ4ç§è°ƒæ•´è§„åˆ™ï¼‰
- [ ] çœ‹åˆ°"è¡¥å¿æœºåˆ¶"è¯´æ˜å’Œå…¬å¼
- [ ] çœ‹åˆ°"éœ‡è¡å¸‚ç‰¹æ®Šå¤„ç†"ç« èŠ‚
- [ ] æ æ†é™åˆ¶æ˜¾ç¤ºä¸º24å€ï¼ˆç»¿è‰²é«˜äº®ï¼‰

#### ICTç­–ç•¥éƒ¨åˆ†
- [ ] ç‚¹å‡»å·¦ä¾§"ICTè®¢å•å—ç­–ç•¥"èƒ½æ­£å¸¸è·³è½¬
- [ ] çœ‹åˆ°"15Må…¥åœºæ¡ä»¶"è¡¨æ ¼ï¼ˆ5ä¸ªé—¨æ§›ï¼‰
- [ ] ç¬¬5ä¸ªé—¨æ§›"æ€»åˆ†â‰¥60åˆ†"æœ‰é»„è‰²èƒŒæ™¯é«˜äº®
- [ ] ä¿¡å·ç”Ÿæˆé€»è¾‘æ›´æ–°ä¸º60åˆ†é˜ˆå€¼
- [ ] è®¢å•å—å¹´é¾„æ˜¾ç¤ºä¸º5å¤©ï¼ˆç»¿è‰²é«˜äº®ï¼‰
- [ ] æ æ†é™åˆ¶æ˜¾ç¤ºä¸º24å€ï¼ˆç»¿è‰²é«˜äº®ï¼‰

#### ç­–ç•¥ä¼˜åŒ–æ›´æ–°ç« èŠ‚
- [ ] ç‚¹å‡»å·¦ä¾§"ç­–ç•¥ä¼˜åŒ–æ›´æ–° (2025-10-08)"èƒ½æ­£å¸¸è·³è½¬
- [ ] çœ‹åˆ°å®Œæ•´çš„ä¿®å¤è¯´æ˜
- [ ] çœ‹åˆ°ä¿®å¤æ•ˆæœå¯¹æ¯”è¡¨æ ¼

**æ³¨æ„ï¼š** å¦‚æœçœ‹åˆ°çš„è¿˜æ˜¯æ—§å†…å®¹ï¼Œè¯·æŒ‰ **Ctrl+Shift+R**ï¼ˆWindowsï¼‰æˆ– **Cmd+Shift+R**ï¼ˆMacï¼‰å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨ç¼“å­˜

---

### 5. éªŒè¯å‰ç«¯ä»ªè¡¨æ¿

**è®¿é—®ï¼š** https://smart.aimaventop.com/dashboard

**éªŒè¯æ¸…å•ï¼š**
- [ ] ICTç­–ç•¥15Må…¥åœºæ˜¾ç¤º"æœ‰æ•ˆ"çš„äº¤æ˜“å¯¹ï¼Œæ€»åˆ†åº”è¯¥â‰¥60åˆ†
- [ ] ICTç­–ç•¥ç½®ä¿¡åº¦æ˜¾ç¤ºä¸ºä¸­æ–‡ï¼ˆé«˜/ä¸­/ä½ï¼‰ï¼Œä¸æ˜¯è‹±æ–‡å­—ç¬¦ä¸²
- [ ] ICTç­–ç•¥æ€»åˆ†ä¸åº”å‡ºç°30/40ç­‰ç¡¬ç¼–ç å€¼
- [ ] V3ç­–ç•¥RANGEè¶‹åŠ¿çš„äº¤æ˜“å¯¹ï¼Œå¦‚æœæœ‰å‡çªç ´åº”æ˜¾ç¤ºBUY/SELL

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šGitæ‹‰å–å¤±è´¥

```bash
# æ£€æŸ¥GitçŠ¶æ€
cd /root/trading-system-v2
git status
git remote -v

# å¦‚æœæœ‰å†²çª
git stash
git pull origin main
git stash pop

# å¦‚æœéœ€è¦å¼ºåˆ¶æ›´æ–°
git fetch origin
git reset --hard origin/main
```

### é—®é¢˜2ï¼šæœåŠ¡é‡å¯å¤±è´¥

```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs main-app --err --lines 50

# æ£€æŸ¥è¯­æ³•é”™è¯¯
cd /root/trading-system-v2
node -c src/strategies/ict-strategy.js
node -c src/strategies/v3-strategy.js

# å¦‚æœæœ‰è¯­æ³•é”™è¯¯ï¼Œå›æ»š
git reset --hard HEAD~1
pm2 restart all
```

### é—®é¢˜3ï¼šå‰ç«¯æ²¡æœ‰æ›´æ–°

```bash
# 1. å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨ç¼“å­˜
# Ctrl+Shift+R (Windows) æˆ– Cmd+Shift+R (Mac)

# 2. æ£€æŸ¥Nginxé…ç½®
nginx -t

# 3. é‡è½½Nginx
nginx -s reload

# 4. æ¸…é™¤æµè§ˆå™¨æ‰€æœ‰ç¼“å­˜
# æµè§ˆå™¨ â†’ è®¾ç½® â†’ æ¸…é™¤æµè§ˆæ•°æ®
```

### é—®é¢˜4ï¼šSSHè¿æ¥é—®é¢˜

**é”™è¯¯ï¼š** `Connection closed by 127.0.0.1 port 10808`

**å¯èƒ½åŸå› ï¼š**
1. SSHç«¯å£è½¬å‘é…ç½®é—®é¢˜
2. æœ¬åœ°~/.ssh/configé…ç½®é”™è¯¯
3. VPSé˜²ç«å¢™è®¾ç½®
4. SSHå¯†é’¥è¿‡æœŸ

**è§£å†³æ–¹æ¡ˆï¼š**
1. ä½¿ç”¨VPS Webæ§åˆ¶å°ä»£æ›¿SSH
2. æ£€æŸ¥æœ¬åœ°SSHé…ç½®æ–‡ä»¶
3. è”ç³»VPSæä¾›å•†æ”¯æŒ
4. å°è¯•ä½¿ç”¨ä¸åŒçš„SSHå®¢æˆ·ç«¯

---

## ğŸ“Š é¢„æœŸæ•ˆæœ

### ICTç­–ç•¥å˜åŒ–

**ä¿¡å·è§¦å‘æ•°é‡ï¼š**
- é¢„æœŸå‡å°‘50-70%
- åªæœ‰é«˜è´¨é‡å¼ºä¿¡å·ï¼ˆæ€»åˆ†â‰¥60åˆ†ï¼‰æ‰è§¦å‘
- èƒœç‡é¢„æœŸæå‡

**å‰ç«¯æ˜¾ç¤ºï¼š**
- å¤§å¤šæ•°äº¤æ˜“å¯¹15Må…¥åœºæ˜¾ç¤º"æ— æ•ˆ"
- æ€»åˆ†åˆ†å¸ƒæ›´åˆç†ï¼ˆä¸å†æœ‰30/40åˆ†ï¼‰
- ç½®ä¿¡åº¦æ˜¾ç¤ºä¸º"é«˜/ä¸­/ä½"

### V3ç­–ç•¥å˜åŒ–

**éœ‡è¡å¸‚äº¤æ˜“ï¼š**
- RANGEè¶‹åŠ¿çš„äº¤æ˜“å¯¹å¯èƒ½å‡ºç°BUY/SELLä¿¡å·
- å‡çªç ´æ£€æµ‹æ›´åŠ å‡†ç¡®

**æƒé‡è°ƒæ•´ï¼š**
- æ—¥å¿—ä¸­ä¼šæ˜¾ç¤ºåŠ¨æ€æƒé‡ä¿¡æ¯
- ä¿¡å·åˆ¤æ–­æ›´åŠ çµæ´»

### æ–‡æ¡£ä½“éªŒ

**ç”¨æˆ·æ”¶ç›Šï¼š**
- ç­–ç•¥é€»è¾‘è¯´æ˜ä¸ä»£ç 100%ä¸€è‡´
- æ¸…æ™°çš„è¡¨æ ¼å±•ç¤ºå¤æ‚é€»è¾‘
- é‡è¦å˜æ›´æœ‰æ˜æ˜¾æç¤º
- ä¾¿äºç†è§£å’Œè°ƒè¯•

---

## âœ… éƒ¨ç½²æˆåŠŸæ ‡å¿—

å®Œæˆä»¥ä¸‹æ£€æŸ¥å³è¡¨ç¤ºéƒ¨ç½²æˆåŠŸï¼š

1. âœ… VPSä¸Šä»£ç å·²æ›´æ–°åˆ°æœ€æ–°æäº¤ï¼ˆb714f94ï¼‰
2. âœ… PM2è¿›ç¨‹çŠ¶æ€ä¸ºonline
3. âœ… APIè¿”å›æ•°æ®ç¬¦åˆæ–°é€»è¾‘
4. âœ… å‰ç«¯æ–‡æ¡£æ˜¾ç¤ºæ–°å†…å®¹
5. âœ… ä»ªè¡¨æ¿æ•°æ®æ­£å¸¸æ˜¾ç¤º

---

## ğŸ“ ç´§æ€¥å›æ»š

å¦‚æœéƒ¨ç½²åå‡ºç°ä¸¥é‡é—®é¢˜ï¼Œç«‹å³æ‰§è¡Œï¼š

```bash
ssh root@smart.aimaventop.com << 'EOF'
cd /root/trading-system-v2
git reset --hard HEAD~1
pm2 restart all
nginx -s reload
EOF
```

è¿™å°†å›æ»šåˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬ã€‚

---

## ğŸ“ æäº¤è®°å½•

**Git Commitï¼š** `b714f94`  
**æäº¤æ—¶é—´ï¼š** 2025-10-08  
**ä¿®æ”¹æ–‡ä»¶ï¼š** 4ä¸ª  
**æ’å…¥è¡Œæ•°ï¼š** 3860è¡Œ  
**åˆ é™¤è¡Œæ•°ï¼š** 979è¡Œ

**ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
1. src/strategies/ict-strategy.js
2. src/strategies/v3-strategy.js
3. src/web/app.js
4. src/web/index.html

---

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œ

è¯·é€šè¿‡ä»¥ä¸‹ä»»ä¸€æ–¹å¼åœ¨VPSä¸Šæ‰§è¡Œï¼š

**æ¨èæ–¹å¼ï¼ˆVPS Webç»ˆç«¯ï¼‰ï¼š**
```bash
cd /root/trading-system-v2
git pull origin main
pm2 restart all
nginx -s reload
pm2 status
```

ç„¶åè®¿é—®ï¼š
- ğŸ“Š ä»ªè¡¨æ¿ï¼šhttps://smart.aimaventop.com/dashboard
- ğŸ“– æ–‡æ¡£ï¼šhttps://smart.aimaventop.com/docs ï¼ˆå¼ºåˆ¶åˆ·æ–°ï¼‰

ä»£ç å·²æˆåŠŸæ¨é€åˆ°GitHubï¼Œç­‰å¾…åœ¨VPSä¸Šæ‹‰å–å¹¶é‡å¯æœåŠ¡ï¼

