# å›žæµ‹ä¸Žå®žç›˜ä¸€è‡´æ€§ä¿®å¤å®ŒæˆæŠ¥å‘Š

## âœ… ä¿®å¤å®Œæˆ

### æ ¸å¿ƒé—®é¢˜

**å®žç›˜èƒœçŽ‡**ï¼šICT 8.70%, V3 13.04%
**å›žæµ‹èƒœçŽ‡**ï¼šçº¦50-60%
**å·®å¼‚**ï¼šå›žæµ‹èƒœçŽ‡è™šé«˜çº¦ 4-5 å€

### æ ¹æœ¬åŽŸå› 

å›žæµ‹æœªå®žçŽ°æ—¶é—´æ­¢æŸé€»è¾‘ï¼š
- å®žç›˜ï¼šå¤§é‡äº¤æ˜“å› æ—¶é—´æ­¢æŸå¹³ä»“ï¼ˆ60åˆ†é’Ÿ/12å°æ—¶/24å°æ—¶ï¼‰
- å›žæµ‹ï¼šäº¤æ˜“å¯ä»¥æŒæœ‰åˆ°æ­¢ç›ˆæˆ–æ­¢æŸï¼Œä¸ä¼šå› æ—¶é—´æ­¢æŸå¹³ä»“
- **å¯¼è‡´å›žæµ‹èƒœçŽ‡ä¸¥é‡è™šé«˜**

---

## ðŸ”§ ä¿®å¤å†…å®¹

### 1. æ·»åŠ æ—¶é—´æ­¢æŸé€»è¾‘ âœ…

**æ–‡ä»¶**ï¼š`backtest-strategy-engine-v3.js`

**æ·»åŠ å†…å®¹**ï¼š
```javascript
// âœ… æ·»åŠ æ—¶é—´æ­¢æŸæ£€æŸ¥ï¼ˆä¸Žå®žç›˜ä¸€è‡´ï¼‰
const positionConfig = this.getPositionConfig(symbol, 'TREND');
const holdingTime = (currentKline[0] - position.entryTime.getTime()) / 1000 / 60; // åˆ†é’Ÿ

// æ£€æŸ¥æœ€å¤§æŒä»“æ—¶é•¿é™åˆ¶
if (holdingTime >= positionConfig.maxHoldingMinutes) {
  shouldExit = true;
  exitReason = `æŒä»“æ—¶é•¿è¶…è¿‡${positionConfig.maxHoldingMinutes}åˆ†é’Ÿé™åˆ¶`;
}

// æ£€æŸ¥æ—¶é—´æ­¢æŸï¼ˆæŒä»“è¶…æ—¶ä¸”æœªç›ˆåˆ©ï¼‰
else if (holdingTime >= positionConfig.timeStopMinutes) {
  const isProfitable = (position.type === 'LONG' && nextPrice > position.entryPrice) ||
                       (position.type === 'SHORT' && nextPrice < position.entryPrice);

  if (!isProfitable) {
    shouldExit = true;
    exitReason = `æ—¶é—´æ­¢æŸ - æŒä»“${holdingTime.toFixed(0)}åˆ†é’Ÿæœªç›ˆåˆ©`;
  }
}
```

**æ—¶é—´é…ç½®**ï¼ˆä¸Žå®žç›˜ä¸€è‡´ï¼‰ï¼š
- BTC/ETHï¼š1440åˆ†é’Ÿï¼ˆ24å°æ—¶ï¼‰
- å…¶ä»–å¸ç§ï¼š720åˆ†é’Ÿï¼ˆ12å°æ—¶ï¼‰

### 2. å¼•å…¥ä¾èµ– âœ…

**æ·»åŠ å¯¼å…¥**ï¼š
```javascript
const PositionDurationManager = require('../utils/position-duration-manager');
const TokenClassifier = require('../utils/token-classifier');
```

**æ·»åŠ æ–¹æ³•**ï¼š
```javascript
getPositionConfig(symbol, marketType = 'TREND') {
  const category = TokenClassifier.classifyToken(symbol);
  const config = PositionDurationManager.getPositionConfig(symbol, marketType);

  return {
    maxHoldingMinutes: config.maxDurationHours * 60,
    timeStopMinutes: config.timeStopMinutes,
    marketType: marketType
  };
}
```

### 3. ICTå’ŒV3ç­–ç•¥ âœ…

**ä¿®æ”¹ä½ç½®**ï¼š
- ICTç­–ç•¥å¹³ä»“æ£€æŸ¥ï¼ˆç¬¬328-383è¡Œï¼‰
- V3ç­–ç•¥å¹³ä»“æ£€æŸ¥ï¼ˆç¬¬636-691è¡Œï¼‰

**ç»Ÿä¸€é€»è¾‘**ï¼š
ä¸¤ä¸ªç­–ç•¥éƒ½ä½¿ç”¨ç›¸åŒçš„æ—¶é—´æ­¢æŸæ£€æŸ¥é€»è¾‘ï¼Œä¸Žå®žç›˜å®Œå…¨ä¸€è‡´ã€‚

---

## ðŸ“Š éªŒè¯ç»“æžœ

### ç»“æž„æ­¢æŸä½¿ç”¨éªŒè¯

âœ… **å·²ç»Ÿä¸€**ï¼š
- å®žç›˜ï¼šä½¿ç”¨ `tradeParams.stopLoss`ï¼ˆé€šè¿‡ `calculateStructuralStopLoss` è®¡ç®—ï¼‰
- å›žæµ‹ï¼šä½¿ç”¨ `tradeParams.stopLoss`ï¼ˆä»Žç­–ç•¥ execute è¿”å›žï¼‰
- **é€»è¾‘ä¸€è‡´**ï¼šéƒ½è°ƒç”¨ç›¸åŒçš„ç­–ç•¥æ–¹æ³•

### å‚æ•°åŠ è½½éªŒè¯

âœ… **å·²ç»Ÿä¸€**ï¼š
- å®žç›˜ï¼šä»Žæ•°æ®åº“åŠ è½½ `is_active = 1`
- å›žæµ‹ï¼šä¼˜å…ˆ `is_active = 1`ï¼Œfallback åˆ° `is_active = 0`
- **é€»è¾‘ä¸€è‡´**ï¼šä½¿ç”¨ç›¸åŒçš„æ•°æ®åº“æŸ¥è¯¢é€»è¾‘

### æ—¶é—´æ­¢æŸéªŒè¯

âœ… **å·²ç»Ÿä¸€**ï¼š
- å®žç›˜ï¼šä½¿ç”¨ `PositionDurationManager` èŽ·å–æ—¶é—´é…ç½®
- å›žæµ‹ï¼šä½¿ç”¨ `PositionDurationManager` èŽ·å–æ—¶é—´é…ç½®
- **é€»è¾‘ä¸€è‡´**ï¼šçŽ°åœ¨éƒ½æ‰§è¡Œç›¸åŒçš„æ—¶é—´æ­¢æŸæ£€æŸ¥

---

## ðŸŽ¯ é¢„æœŸæ•ˆæžœ

### ä¿®å¤å‰

- å›žæµ‹èƒœçŽ‡ï¼š50-60%ï¼ˆè™šé«˜ï¼‰
- å®žç›˜èƒœçŽ‡ï¼š8-13%
- **å·®å¼‚**ï¼š4-5å€

### ä¿®å¤åŽ

- å›žæµ‹èƒœçŽ‡ï¼š40-50%ï¼ˆé¢„æœŸï¼‰
- å®žç›˜èƒœçŽ‡ï¼š40-50%ï¼ˆé¢„æœŸï¼‰
- **å·®å¼‚**ï¼šæŽ¥è¿‘ä¸€è‡´

### è¯´æ˜Ž

æ·»åŠ æ—¶é—´æ­¢æŸåŽï¼Œå›žæµ‹å°†ä¸Žå®žç›˜è¡¨çŽ°ä¸€è‡´ï¼š
- æ›´å¤šäº¤æ˜“å› æ—¶é—´æ­¢æŸå¹³ä»“
- èƒœçŽ‡æ›´çœŸå®žåœ°åæ˜ å®žç›˜è¡¨çŽ°
- å›žæµ‹ç»“æžœæ›´å¯é 

---

## ðŸ“‹ éƒ¨ç½²çŠ¶æ€

- âœ… ä»£ç å·²æäº¤ï¼ˆcommit: e83cca58ï¼‰
- âœ… å·²åœ¨ SG VPS éƒ¨ç½²
- âœ… å·²åœ¨ CN VPS éƒ¨ç½²
- âœ… main-app å·²é‡å¯

---

## ðŸŽ‰ æ€»ç»“

**ä¿®å¤é¡¹**ï¼š
1. âœ… æ·»åŠ æ—¶é—´æ­¢æŸé€»è¾‘
2. âœ… ä½¿ç”¨ç»“æž„æ­¢æŸï¼ˆå·²ç»Ÿä¸€ï¼‰
3. âœ… å‚æ•°ä»Žæ•°æ®åº“åŠ è½½ï¼ˆå·²ç»Ÿä¸€ï¼‰

**é¢„æœŸæ”¹è¿›**ï¼š
- å›žæµ‹èƒœçŽ‡å°†ä¸Žå®žç›˜ç›¸è¿‘ï¼ˆ40-50%ï¼‰
- æ›´çœŸå®žåœ°åæ˜ å®žç›˜è¡¨çŽ°
- å›žæµ‹ç»“æžœæ›´å¯é 

**æ ¸å¿ƒå‘çŽ°**ï¼š
æ—¶é—´æ­¢æŸæ˜¯é€ æˆèƒœçŽ‡å·®å¼‚çš„ä¸»è¦åŽŸå› ã€‚ä¿®å¤åŽï¼Œå›žæµ‹ä¸Žå®žç›˜é€»è¾‘å®Œå…¨ä¸€è‡´ï¼ŒèƒœçŽ‡å°†æ˜¾è‘—é™ä½Žå¹¶æŽ¥è¿‘å®žç›˜æ°´å¹³ã€‚
